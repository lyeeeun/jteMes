<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SHIP_inResultShDel">
<!-- 		                 , FN_CM_GETCOMNM(PI.CTR_CD , 'PRODTYPE', P.PRODTYPE) AS PRODTYPE        
			             , FN_CM_GETCOMNM(PI.CTR_CD , 'PRODSPEC', P.PRODSPEC) AS PRODSPEC       
						 , FN_CM_GETCOMNM(PI.CTR_CD , 'PRODUNITCD',P.PRODUNIT_CD )  AS UNIT_NM  -->
	<select id="selectShipInList" parameterType="hashmap"
		resultType="hashmap">
		<![CDATA[
		
 		SELECT            PI.PROD_IN_NO                                                  	
		                 , DATE_FORMAT(PI.PROD_IN_DATE,'%Y%m%d') AS PROD_IN_DATE            	
		                 , PI.WO_OUT_NO                                                   		
		                 , PI.ORDER_NO                                                    		
		                 , PI.CUSTOMERID                                                  		
		                 , PI.PRODID                                                      		
		                 , C.CUSTOMERNAME                                                 	
		                 , P.PRODNAME                                                     	
		                 , P.PRODMTRL													  		 
		                 , P.PRODTYPE        
			             , P.PRODSPEC    
						 , P.PRODUNIT_CD AS UNIT_NM  
		                 , PI.PROD_IN_QTY                                                       
		                 , PI.PROD_IN_GBN                                                		
		                 , PI.REMARK                                                      		 
		                 , PI.DEL_GBN                                                     	
			FROM TB_MESPRODIN PI
			LEFT JOIN TB_CUSTOMER C ON PI.CUSTOMERID=C.CUSTOMERID
			LEFT JOIN TB_PRODUCT P ON PI.PRODID=P.PRODID
			WHERE 1=1
		]]>
		<!--  삭제 구분에 N 즉 삭제된 데이터가 아닌경우 -->
		<if test='DEL_GBN != "N"'>
			AND PI.DEL_GBN ='N'
		</if>
		<!-- 검색 날짜가 null이 아닐경우 -->
		<if test='STR_DT != null and STR_DT != ""'>
			AND PROD_IN_DATE BETWEEN STR_TO_DATE(#{STR_DT},'%Y%m%d') 
			AND STR_TO_DATE(#{END_DT},'%Y%m%d') 
		</if>
		<!--고객사가 null이 아닌 경우 고객사에 따른 검색이 가능하게함  -->
		<if test='CUSTOMERNAME != null and CUSTOMERNAME != ""'>
				AND CUSTOMERNAME LIKE CONCAT("%"#{CUSTOMERNAME}"%")
		</if>
        <!--제품명이 null이 아닌 경우 제품명에 따른 검색이 가능하게함  -->
		<if test='PRODNAME != null and PRODNAME != ""'>
			AND PRODNAME LIKE CONCAT("%"#{PRODNAME}"%")
		</if>
		    ORDER BY PROD_IN_DATE
	</select>

	<!-- 제품입고 특기사항 수정 -->
	<select id="updateProdInList" parameterType="hashmap"
		resultType="java.lang.Integer">
		<![CDATA[
		    UPDATE TB_MESPRODIN
		       SET REMARK = #{REMARK}
		     WHERE PROD_IN_NO=#{PROD_IN_NO}
		]]>
	</select>
	
</mapper>